# EE5393 Homework 1 Q1 B
# Kenji Vang | vang3841@umn.edu
# ChatGPT has helped generate some code in this file

import random
import numpy as np


# -----------------------------
# Reaction Probabilities Function
# -----------------------------
def probabilitiesNumerator(x1, x2, x3):
   
    p1 = 0.5 * x1 * (x1 - 1) * x2 
    p2 = x1 * x3 * (x3 - 1)
    p3 = 3 * x2 * x3 
    return p1,p2,p3

# -----------------------------
# Run exactly 7 steps
# -----------------------------
def run_7_steps():
    x1, x2, x3 = 9, 8, 7

    for _ in range(7):

        a1, a2, a3 = probabilitiesNumerator(x1, x2, x3)
        total = a1 + a2 + a3

        if total == 0:
            break

        r = random.random() * total

        if r < a1:
            x1 -= 2
            x2 -= 1
            x3 += 4
        elif r < a1 + a2:
            x1 -= 1
            x2 += 3
            x3 -= 2
        else:
            x1 += 2
            x2 -= 1
            x3 -= 1

    return x1, x2, x3


# -----------------------------
# Monte Carlo Estimation
# -----------------------------
def estimate_statistics(trials=50000):

    X1_vals = []
    X2_vals = []
    X3_vals = []

    for _ in range(trials):
        x1, x2, x3 = run_7_steps()
        X1_vals.append(x1)
        X2_vals.append(x2)
        X3_vals.append(x3)

    X1_vals = np.array(X1_vals)
    X2_vals = np.array(X2_vals)
    X3_vals = np.array(X3_vals)

    print("After 7 steps:")
    print("X1 Mean:", np.mean(X1_vals))
    print("X1 Variance:", np.var(X1_vals))
    print()
    print("X2 Mean:", np.mean(X2_vals))
    print("X2 Variance:", np.var(X2_vals))
    print()
    print("X3 Mean:", np.mean(X3_vals))
    print("X3 Variance:", np.var(X3_vals))


if __name__ == "__main__":
    estimate_statistics(50000)